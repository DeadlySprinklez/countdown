<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@500&display=swap" rel="stylesheet"> 
	<style>
		body {
			background-color: #000000;
			font-family: 'Roboto Mono', monospace;
		}
		#countdown {
			font-size: 10vw;
			color: rgb(0,0,0);
			position: fixed;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}
		#hint, #minihint, #guess {
			text-align: center;
			color: rgb(85,85,85);
			position: fixed;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 100vw;
		}
		#hint {
			font-size: 1.25vw;
			top: 80%;
		}
		#minihint {
			font-size: 10pt;
			top: calc(100vh - 10pt);
		}
		#guess {
			top: 90%;
			width: initial;
			cursor: pointer;
			color: rgb(10,10,10);
			text-shadow: 0px 0px 1px rgba(0,255,0,0.5);
		}
		#guess:hover {
			color: rgb(85,85,85);
		}
	</style>
</head>
<body>
	<span id="countdown">0:00:00.000</span>
	<span id="hint">(if you're reading this, you should enable javascript. or wait another second.)</span>
	<span id="guess">???</span>
	<span id="minihint"></span>
	<script>
		function countdown() {
			current = Date.now();
			if (countTo > current) {
				offset = countTo - current;
			}
			else {
				offset = 0;
			}
			timeTo = new Date(offset);
			if (Math.floor(timeTo/60/60/1000) == 0 && Math.floor(timeTo/60/1000%60) <= 10) {
				targetRed = 255;
				targetGreen = 255;
				targetBlue = 0;
			}
			if (Math.floor(timeTo/1000) < 60) {
				targetRed = 255;
				targetGreen = 0;
				targetBlue = 0;
			}
			if (Number(timeTo) == 0) {
				if (!grayed) {
					targetRed = 50;
					targetGreen = 50;
					targetBlue = 50;
					if (red == 50 && green == 50 && blue == 50) {
						grayed = true;
					}
				}
				else if (current % 2000 < 1000) {
					targetRed = 50;
					targetGreen = 50;
					targetBlue = 50;
					red = 50;
					green = 50;
					blue = 50;
				}
				else {
					targetRed = 0;
					targetGreen = 0;
					targetBlue = 0;
					red = 0;
					green = 0;
					blue = 0;
				}
			}
			red = red + (targetRed - red)/30;
			green = green + (targetGreen - green)/30;
			blue = blue + (targetBlue - blue)/30;
			if (targetRed - 1 < red && red < targetRed + 1) {
				red = targetRed;
			}
			if (targetGreen - 1 < green && green < targetGreen + 1) {
				green = targetGreen;
			}
			if (targetBlue - 1 < blue && blue < targetBlue + 1) {
				blue = targetBlue;
			}
			element.style.color = "rgb(" + red + "," + green + "," + blue + ")";
			element.innerHTML = (Math.floor(timeTo/60/60/1000) >= 24 ? Math.floor(timeTo/60/60/1000/24) + ":" : "")
				+ (Math.floor(timeTo/60/60/1000%24) < 10 ? "0" : "") + Math.floor(timeTo/60/60/1000%24) // hours
				+ ":" + (Math.floor(timeTo/60/1000%60) < 10 ? "0" : "") + Math.floor(timeTo/60/1000%60) // minutes
				+ ":" + (Math.floor(timeTo/1000%60) < 10 ? "0" : "") + Math.floor(timeTo/1000%60) // seconds
				+ (Math.floor(timeTo/60/60/1000) > 0 // milliseconds if there's less than one hour left
					? ""
					: "." + (Math.floor(timeTo%1000) < 100 
						? "0" + (Math.floor(timeTo%1000) < 10 
							? "0" + Math.floor(timeTo%1000) 
							: Math.floor(timeTo%1000)) 
						: Math.floor(timeTo%1000)
					)
				);
				document.title = element.innerHTML;
			requestAnimationFrame(countdown);
		}

		red = 0;
		green = 0;
		blue = 0;
		targetRed = 0;
		targetGreen = 255;
		targetBlue = 0;
		grayed = false;
		tips = [
			`for best results, make sure your system time is accurate.`,

			`t + 6 = z...<br>
			oh hey, make sure your system time is accurate.`,

			`nbymy lyginy xiwnilm omy mowb fcnnfy mwlyyhm, von nbys bupy mi<br>
			guhs nchs mkoulym ch nbyg...biq guhs uly nbyly?`,

			`the way this countdown timer is formatted shows<br>
			<b>hours</b>:<b>minutes</b>:<b>seconds</b>.<b>milliseconds</b>.<br>
			but milliseconds only show up when there's less than an hour left.`,

			'I wonder what this is ticking down to...?'
		]
		const element = document.getElementById("countdown");
		const countTo = Date.parse("October 13, 2020 12:00:00 MST");


		document.addEventListener("DOMContentLoaded", function() {
			if (typeof sessionStorage.reloaded == "undefined") {
				document.getElementById("minihint").innerHTML = "(keep reloading the page to get new quotes. they're randomized on each reload!)";
				sessionStorage.reloaded = true;
			}
			if (typeof sessionStorage.lastHint == "undefined") {
				sessionStorage.lastHint = 0;
				document.getElementById("hint").innerHTML = "(" + tips[0] + ")";
				return;
			}
			let randHint = Math.floor(Math.random() * tips.length);
			let attempts = 50;
			while (randHint == sessionStorage.lastHint) {
				randHint = Math.floor(Math.random() * tips.length);
				attempts--;
				if (attempts == 0) {
					break;
				} 
			}
			sessionStorage.lastHint = randHint;
			document.getElementById("hint").innerHTML = "(" + tips[randHint] + ")";
		})


		document.getElementById("guess").addEventListener("click", function() {
			let pw = window.prompt("Enter passcode:");
			switch (pw) {
				case null:
					break;
				case "":
				case " ":
					window.alert("No passcode found.");
					break;
				default:
					window.location = pw + ".png";
					break;
			}
		})


		countdown();
	</script>
</body>